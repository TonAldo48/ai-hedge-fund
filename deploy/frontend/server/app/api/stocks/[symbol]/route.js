(()=>{var e={};e.id=670,e.ids=[670],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},36561:(e,r,o)=>{"use strict";o.r(r),o.d(r,{patchFetch:()=>w,routeModule:()=>h,serverHooks:()=>y,workAsyncStorage:()=>f,workUnitAsyncStorage:()=>m});var t={};o.r(t),o.d(t,{GET:()=>g});var a=o(96559),n=o(48088),i=o(37719),l=o(32190),s=o(87292);let c="YOUR_ALPHA_VANTAGE_API_KEY",u=c&&!1;async function p(e){try{if(!u)return console.warn("Alpha Vantage API key not configured. Get one at https://www.alphavantage.co/support/#api-key"),null;let r=`https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${e}&apikey=${c}`;console.log(`Fetching quote for ${e} from Alpha Vantage`);let o=await fetch(r);if(!o.ok)return console.error(`Failed to fetch quote for ${e}: ${o.statusText}`),null;let t=await o.json();if(t["Error Message"])return console.error(`Alpha Vantage API error: ${t["Error Message"]}`),null;if(!t["Global Quote"]||0===Object.keys(t["Global Quote"]).length)return console.error(`No quote data found for ${e}`),null;let a=t["Global Quote"];return{symbol:a["01. symbol"],price:parseFloat(a["05. price"]),change:parseFloat(a["09. change"]),changePercent:parseFloat(a["10. change percent"].replace("%","")),volume:parseInt(a["06. volume"]),previousClose:parseFloat(a["08. previous close"]),open:parseFloat(a["02. open"]),high:parseFloat(a["03. high"]),low:parseFloat(a["04. low"])}}catch(r){return console.error(`Error fetching quote for ${e} from Alpha Vantage:`,r),null}}async function d(e){try{if(!u)return console.warn("Alpha Vantage API key not configured. Get one at https://www.alphavantage.co/support/#api-key"),null;let r=`https://www.alphavantage.co/query?function=OVERVIEW&symbol=${e}&apikey=${c}`;console.log(`Fetching company overview for ${e} from Alpha Vantage`);let o=await fetch(r);if(!o.ok)return console.error(`Failed to fetch company overview for ${e}: ${o.statusText}`),null;let t=await o.json();if(t["Error Message"])return console.error(`Alpha Vantage API error: ${t["Error Message"]}`),null;if(!t.Symbol)return console.error(`No company overview found for ${e}`),null;return t}catch(r){return console.error(`Error fetching company overview for ${e} from Alpha Vantage:`,r),null}}async function g(e,{params:r}){let o=r.symbol;if(!o)return l.NextResponse.json({error:"Symbol is required"},{status:400});try{if((0,s.HW)())try{console.log(`Fetching quote data for ${o} from Yahoo Finance (RapidAPI)`);let e=await (0,s.fn)(o);if(e){let r={symbol:e.symbol,name:e.longName||e.shortName||o,price:e.regularMarketPrice,change:e.regularMarketChange,changePercent:e.regularMarketChangePercent,volume:e.regularMarketVolume,marketCap:e.marketCap,high52:e.fiftyTwoWeekHigh,low52:e.fiftyTwoWeekLow,pe:e.trailingPE,dividend:e.trailingAnnualDividendRate,yield:e.trailingAnnualDividendYield?100*e.trailingAnnualDividendYield:void 0,source:"Yahoo Finance",lastUpdated:new Date().toISOString()};return l.NextResponse.json(r)}console.warn(`No quote data returned from Yahoo Finance for ${o}, trying Alpha Vantage`)}catch(e){console.error(`Error fetching from Yahoo Finance for ${o}:`,e),console.log("Trying Alpha Vantage as fallback")}else console.log("RapidAPI key not configured, trying Alpha Vantage");if(u)try{console.log(`Fetching quote data for ${o} from Alpha Vantage`);let e=await p(o);if(e){let r=null;try{r=await d(o)}catch(e){console.warn(`Could not fetch company overview for ${o}:`,e)}let t={symbol:e.symbol,name:r?.Name||o,price:e.price,change:e.change,changePercent:e.changePercent,volume:e.volume,marketCap:r?.MarketCapitalization?parseInt(r.MarketCapitalization):void 0,high52:r?.["52WeekHigh"]?parseFloat(r["52WeekHigh"]):void 0,low52:r?.["52WeekLow"]?parseFloat(r["52WeekLow"]):void 0,pe:r?.PERatio?parseFloat(r.PERatio):void 0,dividend:r?.DividendPerShare?parseFloat(r.DividendPerShare):void 0,yield:r?.DividendYield?100*parseFloat(r.DividendYield):void 0,beta:r?.Beta?parseFloat(r.Beta):void 0,sector:r?.Sector,description:r?.Description,source:"Alpha Vantage",lastUpdated:new Date().toISOString()};return l.NextResponse.json(t)}console.warn(`No quote data returned from Alpha Vantage for ${o}, falling back to backend API`)}catch(e){console.error(`Error fetching from Alpha Vantage for ${o}:`,e),console.log("Falling back to backend API")}else console.log("Alpha Vantage API key not configured, using backend API");let e=await fetch(`http://127.0.0.1:8000/api/stocks/${o}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok){let r=await e.json().catch(()=>null);return console.error(`Error from stock API for ${o}:`,r),l.NextResponse.json({error:`Failed to fetch details for ${o}`,details:r},{status:e.status})}let r=await e.json();return l.NextResponse.json(r)}catch(e){return console.error(`Error processing stock request for ${o}:`,e),l.NextResponse.json({error:`Failed to process request for ${o}`},{status:500})}}let h=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/stocks/[symbol]/route",pathname:"/api/stocks/[symbol]",filename:"route",bundlePath:"app/api/stocks/[symbol]/route"},resolvedPagePath:"/Users/dn/Documents/GitHub.nosync/ai-hedge-fund/ai/ai-hedge-fund/web/src/app/api/stocks/[symbol]/route.ts",nextConfigOutput:"",userland:t}),{workAsyncStorage:f,workUnitAsyncStorage:m,serverHooks:y}=h;function w(){return(0,i.patchFetch)({workAsyncStorage:f,workUnitAsyncStorage:m})}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},87292:(e,r,o)=>{"use strict";o.d(r,{EA:()=>u,HW:()=>i,Z1:()=>s,fn:()=>l,yM:()=>c});let t="YOUR_RAPIDAPI_KEY_HERE",a="yahoo-finance15.p.rapidapi.com",n=t&&!1;function i(){return n}async function l(e){try{if(!n)return console.warn("RapidAPI key not configured. Set NEXT_PUBLIC_RAPIDAPI_KEY in .env.local"),null;let r=`https://${a}/api/yahoo/qu/quote/${e}`;console.log(`Fetching quote for ${e} from RapidAPI Yahoo Finance`);let o=await fetch(r,{method:"GET",headers:{"X-RapidAPI-Key":t,"X-RapidAPI-Host":a}});if(!o.ok)return console.error(`Failed to fetch quote for ${e}: Status ${o.status} - ${o.statusText}`),(401===o.status||403===o.status)&&console.error("API key may be invalid or subscription inactive. Visit https://rapidapi.com/apidojo/api/yahoo-finance15/"),null;let i=await o.json();if(!i)return console.error(`No data returned for ${e}`),null;if(i.message&&i.message.includes("error"))return console.error(`API error for ${e}:`,i.message),null;if(!i.symbol)return console.error(`Invalid data format for ${e}:`,JSON.stringify(i).substring(0,200)),null;return{symbol:i.symbol,regularMarketPrice:i.regularMarketPrice?.raw||0,regularMarketChange:i.regularMarketChange?.raw||0,regularMarketChangePercent:i.regularMarketChangePercent?.raw||0,regularMarketVolume:i.regularMarketVolume?.raw||0,marketCap:i.marketCap?.raw||0,regularMarketOpen:i.regularMarketOpen?.raw||0,regularMarketDayHigh:i.regularMarketDayHigh?.raw||0,regularMarketDayLow:i.regularMarketDayLow?.raw||0,regularMarketTime:i.regularMarketTime?.raw||0,currency:i.currency||"USD",exchange:i.exchange||"",shortName:i.shortName||"",longName:i.longName||"",fiftyTwoWeekHigh:i.fiftyTwoWeekHigh?.raw||0,fiftyTwoWeekLow:i.fiftyTwoWeekLow?.raw||0,trailingPE:i.trailingPE?.raw,trailingAnnualDividendYield:i.trailingAnnualDividendYield?.raw,trailingAnnualDividendRate:i.trailingAnnualDividendRate?.raw}}catch(r){return console.error(`Error fetching quote for ${e}:`,r),null}}async function s(e,r="3mo",o="1d"){try{if(!n)return console.warn("RapidAPI key not configured. Please sign up at https://rapidapi.com/apidojo/api/yahoo-finance1/"),[];let i=`https://${a}/api/yahoo/hi/history/${e}/${o}/${r}`;console.log(`Fetching historical data for ${e} from RapidAPI Yahoo Finance`);let l=await fetch(i,{method:"GET",headers:{"X-RapidAPI-Key":t,"X-RapidAPI-Host":a}});if(!l.ok)return console.error(`Failed to fetch historical data for ${e}: ${l.statusText}`),[];let s=await l.json();if(!s||!s.items||0===Object.keys(s.items).length)return console.error(`No historical data found for ${e}`),[];let c=Object.keys(s.items).map(e=>{let r=s.items[e];return{date:new Date(1e3*parseInt(e)),open:r.open||0,high:r.high||0,low:r.low||0,close:r.close||0,volume:r.volume||0,adjClose:r.adjclose||r.close||0}}).filter(e=>e.open&&e.high&&e.low&&e.close);return c.sort((e,r)=>e.date.getTime()-r.date.getTime()),c}catch(r){return console.error(`Error fetching historical data for ${e}:`,r),[]}}function c(e){switch(e){case"1D":return{period:"1d",interval:"5m"};case"1W":return{period:"5d",interval:"15m"};case"1M":return{period:"1mo",interval:"1d"};case"3M":default:return{period:"3mo",interval:"1d"};case"1Y":return{period:"1y",interval:"1d"};case"5Y":return{period:"5y",interval:"1wk"}}}function u(e){return e.map(e=>({date:e.date.toISOString().split("T")[0],open:e.open,high:e.high,low:e.low,close:e.close,price:e.close,volume:e.volume}))}},96487:()=>{}};var r=require("../../../../webpack-runtime.js");r.C(e);var o=e=>r(r.s=e),t=r.X(0,[447,580],()=>o(36561));module.exports=t})();
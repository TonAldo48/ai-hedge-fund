(()=>{var e={};e.id=883,e.ids=[883],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},87292:(e,r,t)=>{"use strict";t.d(r,{EA:()=>u,HW:()=>i,Z1:()=>l,fn:()=>s,yM:()=>c});let o="YOUR_RAPIDAPI_KEY_HERE",a="yahoo-finance15.p.rapidapi.com",n=o&&!1;function i(){return n}async function s(e){try{if(!n)return console.warn("RapidAPI key not configured. Set NEXT_PUBLIC_RAPIDAPI_KEY in .env.local"),null;let r=`https://${a}/api/yahoo/qu/quote/${e}`;console.log(`Fetching quote for ${e} from RapidAPI Yahoo Finance`);let t=await fetch(r,{method:"GET",headers:{"X-RapidAPI-Key":o,"X-RapidAPI-Host":a}});if(!t.ok)return console.error(`Failed to fetch quote for ${e}: Status ${t.status} - ${t.statusText}`),(401===t.status||403===t.status)&&console.error("API key may be invalid or subscription inactive. Visit https://rapidapi.com/apidojo/api/yahoo-finance15/"),null;let i=await t.json();if(!i)return console.error(`No data returned for ${e}`),null;if(i.message&&i.message.includes("error"))return console.error(`API error for ${e}:`,i.message),null;if(!i.symbol)return console.error(`Invalid data format for ${e}:`,JSON.stringify(i).substring(0,200)),null;return{symbol:i.symbol,regularMarketPrice:i.regularMarketPrice?.raw||0,regularMarketChange:i.regularMarketChange?.raw||0,regularMarketChangePercent:i.regularMarketChangePercent?.raw||0,regularMarketVolume:i.regularMarketVolume?.raw||0,marketCap:i.marketCap?.raw||0,regularMarketOpen:i.regularMarketOpen?.raw||0,regularMarketDayHigh:i.regularMarketDayHigh?.raw||0,regularMarketDayLow:i.regularMarketDayLow?.raw||0,regularMarketTime:i.regularMarketTime?.raw||0,currency:i.currency||"USD",exchange:i.exchange||"",shortName:i.shortName||"",longName:i.longName||"",fiftyTwoWeekHigh:i.fiftyTwoWeekHigh?.raw||0,fiftyTwoWeekLow:i.fiftyTwoWeekLow?.raw||0,trailingPE:i.trailingPE?.raw,trailingAnnualDividendYield:i.trailingAnnualDividendYield?.raw,trailingAnnualDividendRate:i.trailingAnnualDividendRate?.raw}}catch(r){return console.error(`Error fetching quote for ${e}:`,r),null}}async function l(e,r="3mo",t="1d"){try{if(!n)return console.warn("RapidAPI key not configured. Please sign up at https://rapidapi.com/apidojo/api/yahoo-finance1/"),[];let i=`https://${a}/api/yahoo/hi/history/${e}/${t}/${r}`;console.log(`Fetching historical data for ${e} from RapidAPI Yahoo Finance`);let s=await fetch(i,{method:"GET",headers:{"X-RapidAPI-Key":o,"X-RapidAPI-Host":a}});if(!s.ok)return console.error(`Failed to fetch historical data for ${e}: ${s.statusText}`),[];let l=await s.json();if(!l||!l.items||0===Object.keys(l.items).length)return console.error(`No historical data found for ${e}`),[];let c=Object.keys(l.items).map(e=>{let r=l.items[e];return{date:new Date(1e3*parseInt(e)),open:r.open||0,high:r.high||0,low:r.low||0,close:r.close||0,volume:r.volume||0,adjClose:r.adjclose||r.close||0}}).filter(e=>e.open&&e.high&&e.low&&e.close);return c.sort((e,r)=>e.date.getTime()-r.date.getTime()),c}catch(r){return console.error(`Error fetching historical data for ${e}:`,r),[]}}function c(e){switch(e){case"1D":return{period:"1d",interval:"5m"};case"1W":return{period:"5d",interval:"15m"};case"1M":return{period:"1mo",interval:"1d"};case"3M":default:return{period:"3mo",interval:"1d"};case"1Y":return{period:"1y",interval:"1d"};case"5Y":return{period:"5y",interval:"1wk"}}}function u(e){return e.map(e=>({date:e.date.toISOString().split("T")[0],open:e.open,high:e.high,low:e.low,close:e.close,price:e.close,volume:e.volume}))}},89768:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>f,routeModule:()=>u,serverHooks:()=>h,workAsyncStorage:()=>d,workUnitAsyncStorage:()=>p});var o={};t.r(o),t.d(o,{GET:()=>c});var a=t(96559),n=t(48088),i=t(37719),s=t(32190),l=t(87292);async function c(e,{params:r}){let t=r.symbol,{searchParams:o}=new URL(e.url),a=o.get("timeframe")||"3M";if(!t)return s.NextResponse.json({error:"Symbol is required"},{status:400});try{if((0,l.HW)())try{console.log(`Fetching historical data for ${t} from Yahoo Finance (RapidAPI) with timeframe ${a}`);let{period:e,interval:r}=(0,l.yM)(a),o=await (0,l.Z1)(t,e,r);if(o&&o.length>0){let e=(0,l.EA)(o);return s.NextResponse.json({symbol:t,timeframe:a,history:e,source:"Yahoo Finance",lastUpdated:new Date().toISOString()})}console.warn(`No data returned from Yahoo Finance for ${t}, falling back to backend API`)}catch(e){console.error(`Error fetching from Yahoo Finance for ${t}:`,e),console.log("Falling back to backend API")}else console.log("RapidAPI key not configured, using backend API");let e=await fetch(`http://127.0.0.1:8000/api/stocks/${t}/history?timeframe=${a}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok){let r=await e.json().catch(()=>null);return console.error(`Error from stock history API for ${t}:`,r),s.NextResponse.json({error:`Failed to fetch history for ${t}`,details:r},{status:e.status})}let r=await e.json();return s.NextResponse.json(r)}catch(e){return console.error(`Error processing stock history request for ${t}:`,e),s.NextResponse.json({error:`Failed to process history request for ${t}`},{status:500})}}let u=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/stocks/[symbol]/history/route",pathname:"/api/stocks/[symbol]/history",filename:"route",bundlePath:"app/api/stocks/[symbol]/history/route"},resolvedPagePath:"/Users/dn/Documents/GitHub.nosync/ai-hedge-fund/ai/ai-hedge-fund/web/src/app/api/stocks/[symbol]/history/route.ts",nextConfigOutput:"",userland:o}),{workAsyncStorage:d,workUnitAsyncStorage:p,serverHooks:h}=u;function f(){return(0,i.patchFetch)({workAsyncStorage:d,workUnitAsyncStorage:p})}},96487:()=>{}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[447,580],()=>t(89768));module.exports=o})();